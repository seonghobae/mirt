<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Item fit statistics — itemfit • mirt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Item fit statistics — itemfit"><meta name="description" content="Computes item-fit statistics for a variety of unidimensional and multidimensional models.
Poorly fitting items should be inspected with the empirical plots/tables
for unidimensional models, otherwise itemGAM can be used to diagnose
where the functional form of the IRT model was misspecified, or models can be refit using
more flexible semi-parametric response models (e.g., itemtype = 'spline').
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing use_dentype_estimate = TRUE will use the internally saved quadrature and
density components (where applicable). Currently, only S-X2 statistic supported for
mixture IRT models. Finally, where applicable the root mean-square error of approximation (RMSEA)
is reported to help gauge the magnitude of item misfit."><meta property="og:description" content="Computes item-fit statistics for a variety of unidimensional and multidimensional models.
Poorly fitting items should be inspected with the empirical plots/tables
for unidimensional models, otherwise itemGAM can be used to diagnose
where the functional form of the IRT model was misspecified, or models can be refit using
more flexible semi-parametric response models (e.g., itemtype = 'spline').
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing use_dentype_estimate = TRUE will use the internally saved quadrature and
density components (where applicable). Currently, only S-X2 statistic supported for
mixture IRT models. Finally, where applicable the root mean-square error of approximation (RMSEA)
is reported to help gauge the magnitude of item misfit."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mirt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.42.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mirt-vignettes.html">UNKNOWN TITLE</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/philchalmers/mirt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Item fit statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/philchalmers/mirt/blob/main/R/itemfit.R" class="external-link"><code>R/itemfit.R</code></a></small>
      <div class="d-none name"><code>itemfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes item-fit statistics for a variety of unidimensional and multidimensional models.
Poorly fitting items should be inspected with the empirical plots/tables
for unidimensional models, otherwise <code><a href="itemGAM.html">itemGAM</a></code> can be used to diagnose
where the functional form of the IRT model was misspecified, or models can be refit using
more flexible semi-parametric response models (e.g., <code>itemtype = 'spline'</code>).
If the latent trait density was approximated (e.g., Davidian curves, Empirical histograms, etc)
then passing <code>use_dentype_estimate = TRUE</code> will use the internally saved quadrature and
density components (where applicable). Currently, only S-X2 statistic supported for
mixture IRT models. Finally, where applicable the root mean-square error of approximation (RMSEA)
is reported to help gauge the magnitude of item misfit.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">itemfit</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  fit_stats <span class="op">=</span> <span class="st">"S_X2"</span>,</span>
<span>  which.items <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="extract.mirt.html">extract.mirt</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"nitems"</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p.adjust <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  group.bins <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  group.size <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  group.fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  mincell <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mincell.X2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  return.tables <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pv_draws <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  boot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  boot_dfapprox <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  S_X2.plot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  S_X2.plot_raw.score <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ETrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  ETpoints <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  empirical.plot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  empirical.CI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  empirical.poly.collapse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"EAP"</span>,</span>
<span>  Theta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par.strip.text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"#9ECAE1"</span><span class="op">)</span>, strip.border <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span></span>
<span>    <span class="st">"black"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">"right"</span>, points <span class="op">=</span> <span class="cn">FALSE</span>, lines <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a computed model object of class <code>SingleGroupClass</code>,
<code>MultipleGroupClass</code>, or <code>DiscreteClass</code></p></dd>


<dt id="arg-fit-stats">fit_stats<a class="anchor" aria-label="anchor" href="#arg-fit-stats"></a></dt>
<dd><p>a character vector indicating which fit statistics should be computed.
  Supported inputs are:</p>
<ul><li><p><code>'S_X2'</code> : Orlando and Thissen (2000, 2003) and
    Kang and Chen's (2007) signed chi-squared test (default)</p></li>
<li><p><code>'Zh'</code> : Drasgow, Levine, &amp; Williams (1985) Zh</p></li>
<li><p><code>'X2'</code> : Bock's (1972) chi-squared method.
    The default inputs compute Yen's (1981) Q1 variant of the X2 statistic
    (i.e., uses a fixed <code>group.bins = 10</code>). However, Bock's group-size variable
    median-based method can be computed by passing <code>group.fun = median</code> and
    modifying the <code>group.size</code> input to the desired number of bins</p></li>
<li><p><code>'G2'</code> : McKinley &amp; Mills (1985) G2 statistic (similar method to Q1,
    but with the likelihood-ratio test).</p></li>
<li><p><code>'PV_Q1'</code> : Chalmers and Ng's (2017) plausible-value variant
    of the Q1 statistic.</p></li>
<li><p><code>'PV_Q1*'</code> : Chalmers and Ng's (2017) plausible-value variant
    of the Q1 statistic that uses parametric bootstrapping to obtain a suitable empirical
    distribution.</p></li>
<li><p><code>'X2*'</code> : Stone's (2000) fit statistics that require parametric
    bootstrapping</p></li>
<li><p><code>'X2*_df'</code> : Stone's (2000) fit statistics that require parametric
    bootstrapping to obtain scaled versions of the X2* and degrees of freedom</p></li>
<li><p><code>'infit'</code> : Compute the infit and outfit statistics</p></li>
</ul><p>Note that 'S_X2' and 'Zh' cannot be computed when there are missing response data
(i.e., will require multiple-imputation/row-removal techniques).</p></dd>


<dt id="arg-which-items">which.items<a class="anchor" aria-label="anchor" href="#arg-which-items"></a></dt>
<dd><p>an integer vector indicating which items to test for fit.
Default tests all possible items</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>logical; remove rows with any missing values? This is required for methods such
as S-X2 because they require the "EAPsum" method from <code><a href="fscores.html">fscores</a></code></p></dd>


<dt id="arg-p-adjust">p.adjust<a class="anchor" aria-label="anchor" href="#arg-p-adjust"></a></dt>
<dd><p>method to use for adjusting all p-values for each respective item fit
statistic (see <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code> for available options). Default is <code>'none'</code></p></dd>


<dt id="arg-group-bins">group.bins<a class="anchor" aria-label="anchor" href="#arg-group-bins"></a></dt>
<dd><p>the number of bins to use for X2 and G2. For example,
setting <code>group.bins = 10</code> will will compute Yen's (1981) Q1 statistic when <code>'X2'</code> is
requested</p></dd>


<dt id="arg-group-size">group.size<a class="anchor" aria-label="anchor" href="#arg-group-size"></a></dt>
<dd><p>approximate size of each group to be used in calculating the \(\chi^2\)
statistic. The default <code>NA</code>
disables this command and instead uses the <code>group.bins</code> input to try and construct
equally sized bins</p></dd>


<dt id="arg-group-fun">group.fun<a class="anchor" aria-label="anchor" href="#arg-group-fun"></a></dt>
<dd><p>function used when <code>'X2'</code> or <code>'G2'</code> are computed. Determines the central
tendency measure within each partitioned group. E.g., setting <code>group.fun = median</code> will
obtain the median of each respective ability estimate in each subgroup (this is what was used
by Bock, 1972)</p></dd>


<dt id="arg-mincell">mincell<a class="anchor" aria-label="anchor" href="#arg-mincell"></a></dt>
<dd><p>the minimum expected cell size to be used in the S-X2 computations. Tables will be
collapsed across items first if polytomous, and then across scores if necessary</p></dd>


<dt id="arg-mincell-x-">mincell.X2<a class="anchor" aria-label="anchor" href="#arg-mincell-x-"></a></dt>
<dd><p>the minimum expected cell size to be used in the X2 computations. Tables will be
collapsed if polytomous, however if this condition can not be met then the group block will
be omitted in the computations</p></dd>


<dt id="arg-return-tables">return.tables<a class="anchor" aria-label="anchor" href="#arg-return-tables"></a></dt>
<dd><p>logical; return tables when investigating <code>'X2'</code>, <code>'S_X2'</code>,
and <code>'X2*'</code>?</p></dd>


<dt id="arg-pv-draws">pv_draws<a class="anchor" aria-label="anchor" href="#arg-pv-draws"></a></dt>
<dd><p>number of plausible-value draws to obtain for PV_Q1 and PV_Q1*</p></dd>


<dt id="arg-boot">boot<a class="anchor" aria-label="anchor" href="#arg-boot"></a></dt>
<dd><p>number of parametric bootstrap samples to create for PV_Q1* and X2*</p></dd>


<dt id="arg-boot-dfapprox">boot_dfapprox<a class="anchor" aria-label="anchor" href="#arg-boot-dfapprox"></a></dt>
<dd><p>number of parametric bootstrap samples to create for the X2*_df statistic
to approximate the scaling factor for X2* as well as the scaled degrees of freedom estimates</p></dd>


<dt id="arg-s-x-plot">S_X2.plot<a class="anchor" aria-label="anchor" href="#arg-s-x-plot"></a></dt>
<dd><p>argument input is the same as <code>empirical.plot</code>, however the resulting image
is constructed according to the S-X2 statistic's conditional sum-score information</p></dd>


<dt id="arg-s-x-plot-raw-score">S_X2.plot_raw.score<a class="anchor" aria-label="anchor" href="#arg-s-x-plot-raw-score"></a></dt>
<dd><p>logical; use the raw-score information in the plot in stead of the latent
trait scale score? Default is <code>FALSE</code></p></dd>


<dt id="arg-etrange">ETrange<a class="anchor" aria-label="anchor" href="#arg-etrange"></a></dt>
<dd><p>range of integration nodes for Stone's X2* statistic</p></dd>


<dt id="arg-etpoints">ETpoints<a class="anchor" aria-label="anchor" href="#arg-etpoints"></a></dt>
<dd><p>number of integration nodes to use for Stone's X2* statistic</p></dd>


<dt id="arg-empirical-plot">empirical.plot<a class="anchor" aria-label="anchor" href="#arg-empirical-plot"></a></dt>
<dd><p>a single numeric value or character of the item name indicating which
item to plot (via <code>itemplot</code>) and overlay with the empirical \(\theta\) groupings (see
<code>empirical.CI</code>). Useful for plotting the expected bins based on the <code>'X2'</code> or
<code>'G2'</code> method</p></dd>


<dt id="arg-empirical-ci">empirical.CI<a class="anchor" aria-label="anchor" href="#arg-empirical-ci"></a></dt>
<dd><p>a numeric value indicating the width of the empirical confidence interval
ranging between 0 and 1 (default of 0 plots not interval). For example, a 95<!-- % confidence -->
interval would be plotted when <code>empirical.CI = .95</code>. Only applicable to dichotomous items</p></dd>


<dt id="arg-empirical-poly-collapse">empirical.poly.collapse<a class="anchor" aria-label="anchor" href="#arg-empirical-poly-collapse"></a></dt>
<dd><p>logical; collapse polytomous item categories to for expected scoring
functions for empirical plots? Default is <code>FALSE</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>type of factor score estimation method. See <code><a href="fscores.html">fscores</a></code> for more detail</p></dd>


<dt id="arg-theta">Theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>a matrix of factor scores for each person used for statistics that require
empirical estimates. If supplied, arguments typically passed to <code><a href="fscores.html">fscores()</a></code> will be
ignored and these values will be used instead. Also required when estimating statistics
with missing data via imputation</p></dd>


<dt id="arg-par-strip-text">par.strip.text<a class="anchor" aria-label="anchor" href="#arg-par-strip-text"></a></dt>
<dd><p>plotting argument passed to <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code></p></dd>


<dt id="arg-par-settings">par.settings<a class="anchor" aria-label="anchor" href="#arg-par-settings"></a></dt>
<dd><p>plotting argument passed to <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code></p></dd>


<dt id="arg-auto-key">auto.key<a class="anchor" aria-label="anchor" href="#arg-auto-key"></a></dt>
<dd><p>plotting argument passed to <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments to be passed to <code><a href="fscores.html">fscores()</a></code> and <code><a href="https://rdrr.io/pkg/lattice/man/Lattice.html" class="external-link">lattice</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bock, R. D. (1972). Estimating item parameters and latent ability when responses are scored
in two or more nominal categories. <em>Psychometrika, 37</em>, 29-51.</p>
<p>Chalmers, R., P. (2012). mirt: A Multidimensional Item Response Theory
Package for the R Environment. <em>Journal of Statistical Software, 48</em>(6), 1-29.
<a href="https://doi.org/10.18637/jss.v048.i06" class="external-link">doi:10.18637/jss.v048.i06</a></p>
<p>Chalmers, R. P. &amp; Ng, V. (2017). Plausible-Value Imputation Statistics for Detecting
Item Misfit. <em>Applied Psychological Measurement, 41</em>, 372-387.
<a href="https://doi.org/10.1177/0146621617692079" class="external-link">doi:10.1177/0146621617692079</a></p>
<p>Drasgow, F., Levine, M. V., &amp; Williams, E. A. (1985). Appropriateness measurement with
polychotomous item response models and standardized indices.
<em>British Journal of Mathematical and Statistical Psychology, 38</em>, 67-86.</p>
<p>Kang, T. &amp; Chen, Troy, T. (2007). An investigation of the performance of the generalized
S-X2 item-fit index for polytomous IRT models. ACT</p>
<p>McKinley, R., &amp; Mills, C. (1985). A comparison of several goodness-of-fit statistics.
Applied Psychological Measurement, 9, 49-57.</p>
<p>Orlando, M. &amp; Thissen, D. (2000). Likelihood-based item fit indices for dichotomous item
response theory models. <em>Applied Psychological Measurement, 24</em>, 50-64.</p>
<p>Reise, S. P. (1990). A comparison of item- and person-fit methods of assessing model-data fit
in IRT. <em>Applied Psychological Measurement, 14</em>, 127-137.</p>
<p>Stone, C. A. (2000). Monte Carlo Based Null Distribution for an Alternative Goodness-of-Fit
Test Statistics in IRT Models. <em>Journal of Educational Measurement, 37</em>, 58-75.</p>
<p>Wright B. D. &amp; Masters, G. N. (1982). <em>Rating scale analysis</em>. MESA Press.</p>
<p>Yen, W. M. (1981). Using simulation results to choose a latent trait model.
<em>Applied Psychological Measurement, 5</em>, 245-262.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="personfit.html">personfit</a></code>, <code><a href="itemGAM.html">itemGAM</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Theta</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#make some data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>, meanlog<span class="op">=</span><span class="fl">0</span>, sdlog <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu">P</span><span class="op">(</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">baditem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">baditem</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ps</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">ps</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>, <span class="fl">2000</span>, <span class="va">items</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span>, baditem<span class="op">=</span><span class="va">baditem</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">raschfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># p-value adjustment</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, p.adjust<span class="op">=</span><span class="st">'fdr'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># two different fit stats (with/without p-value adjustment)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span> ,<span class="st">'X2'</span><span class="op">)</span>, p.adjust<span class="op">=</span><span class="st">'fdr'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span> ,<span class="st">'X2'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Conditional sum-score plot from S-X2 information</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># good fit</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># good fit</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, S_X2.plot <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="co"># bad fit</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span><span class="op">)</span> <span class="co"># just X2</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co"># X2 with maximum-likelihood estimates for traits</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, group.bins<span class="op">=</span><span class="fl">15</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co">#empirical item plot with 15 points</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, group.bins<span class="op">=</span><span class="fl">15</span>, empirical.plot <span class="op">=</span> <span class="fl">21</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PV and X2* statistics (parametric bootstrap stats not run to save time)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'PV_Q1'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="mirtCluster.html">mirtCluster</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># improve speed of bootstrap samples by running in parallel</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'PV_Q1*')</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'X2*') # Stone's 1993 statistic</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(x, 'X2*_df') # Stone's 2000 scaled statistic with df estimate</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># empirical tables for X2 statistic</span></span></span>
<span class="r-in"><span><span class="va">tabs</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">x</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, which.items <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tabs</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#infit/outfit statistics. method='ML' agrees better with eRm package</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'infit'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co">#infit and outfit stats</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#same as above, but inputting ML estimates instead (saves time for re-use)</span></span></span>
<span class="r-in"><span><span class="va">Theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">raschfit</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'infit'</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, empirical.plot<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, Theta<span class="op">=</span><span class="va">Theta</span>, which.items<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit a new more flexible model for the mis-fitting item</span></span></span>
<span class="r-in"><span><span class="va">itemtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'2PL'</span>, <span class="fl">20</span><span class="op">)</span>, <span class="st">'spline'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="va">itemtype</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="itemplot.html">itemplot</a></span><span class="op">(</span><span class="va">x2</span>, <span class="fl">21</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#similar example to Kang and Chen 2007</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>,<span class="fl">.4</span>,<span class="fl">.7</span>, <span class="fl">.8</span>, <span class="fl">.4</span>, <span class="fl">.7</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.0</span>,<span class="fl">0.0</span>,<span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="simdata.html">simdata</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">d</span>,<span class="fl">2000</span>, itemtype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'graded'</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, <span class="st">'X2'</span><span class="op">)</span> <span class="co"># less useful given inflated Type I error rates</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, empirical.plot <span class="op">=</span> <span class="fl">1</span>, empirical.poly.collapse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># collapsed tables (see mincell.X2) for X2 and G2</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, <span class="st">'X2'</span>, return.tables <span class="op">=</span> <span class="cn">TRUE</span>, which.items <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, <span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">mod2</span>, <span class="st">'infit'</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># massive list of tables for S-X2</span></span></span>
<span class="r-in"><span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu">itemfit</span><span class="op">(</span><span class="va">mod</span>, return.tables <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#observed and expected total score patterns for item 1 (post collapsing)</span></span></span>
<span class="r-in"><span><span class="va">tables</span><span class="op">$</span><span class="va">O</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">tables</span><span class="op">$</span><span class="va">E</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># can also select specific items</span></span></span>
<span class="r-in"><span><span class="co"># itemfit(mod, return.tables = TRUE, which.items=1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit stats with missing data (run in parallel using all cores)</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">raschfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mirt.html">mirt</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">1</span>, itemtype<span class="op">=</span><span class="st">'Rasch'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use only valid data by removing rows with missing terms</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'S_X2'</span>, <span class="st">'infit'</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note that X2, G2, PV-Q1, and X2* do not require complete datasets</span></span></span>
<span class="r-in"><span><span class="va">thetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="fscores.html">fscores</a></span><span class="op">(</span><span class="va">raschfit</span>, method <span class="op">=</span> <span class="st">'ML'</span><span class="op">)</span> <span class="co"># save for faster computations</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X2'</span>, <span class="st">'G2'</span><span class="op">)</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, empirical.plot<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">itemfit</span><span class="op">(</span><span class="va">raschfit</span>, <span class="st">'X2'</span>, return.tables<span class="op">=</span><span class="cn">TRUE</span>, which.items<span class="op">=</span><span class="fl">1</span>, Theta<span class="op">=</span><span class="va">thetas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Chalmers.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

